define([],function(){var a=function(){return $("input[name='id']:checked")},b=function(a){return $("tr.row-"+a).find(".c1").html()},c=function(){var b=a();$("#job_number").html(b.length)},d=function(){var c=a();c.length>0&&$("#display_list_toggle").show(),$("#jobs > ul").html(""),$.each(c,function(a,c){$("#jobs > ul").append("<li>"+b($(c).val())+"</li>")})},e=function(){var b=a();return 0==b.length?($("#push_deliveries").attr("disabled","disabled"),void $("#merge_deliveries").attr("disabled","disabled")):1==b.length?($("#push_deliveries").removeAttr("disabled"),void $("#merge_deliveries").attr("disabled","disabled")):($("#push_deliveries").removeAttr("disabled"),void $("#merge_deliveries").removeAttr("disabled"))},f=function(){c(),d(),e()};return{init:function(){$("#display_list_toggle").hide(),$("#display_list_toggle").on("click",function(){$("#jobs > ul").toggle()}),$("input[name=id]").on("change",f),$("#select_all").on("click",function(){$("input[name=id]:not(:checked)").trigger("click")}),$("#deselect_all").on("click",function(){$("input[name=id]:checked").trigger("click")}),require(["core/ajax","core/notification"],function(b,c){$("#push_deliveries").on("click",function(){var d=a(),e=[];$.each(d,function(a,b){var c=$(b).val();e.push({methodname:"local_connect_push_module",args:{id:c}})});var g=b.call(e);$.each(g,function(a,b){g[a].done(function(b){$("tr.row-"+e[a].args.id).remove(),f()}),g[a].fail(c.exception)})}),$("#merge_deliveries").on("click",function(){var d=a().toArray(),e=$(d.shift()).val(),g=b.call([{methodname:"local_connect_push_module",args:{id:e}}]);g[0].done(function(a){$("tr.row-"+e).remove(),f();var g=[];$.each(d,function(b,c){var d=$(c).val();g.push({methodname:"local_connect_link_module",args:{id:d,moodleid:a}})});var h=b.call(g);$.each(h,function(a,b){h[a].done(function(b){$("tr.row-"+g[a].args.id).remove(),f()}),h[a].fail(c.exception)})}),g[0].fail(c.exception)})})}}});